<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>PDF é è¦½èˆ‡åŒ¯å‡º</title>
  <style>
    body { font-family: "Noto Sans TC", sans-serif; padding: 2rem; line-height: 1.6; }
    h1, h2, h3 { margin: 1rem 0 0.5rem; }
    .section-block { margin-top: 2rem; }
    table { width: 100%; border-collapse: collapse; margin-top: 0.5rem; }
    td { border: 1px solid #ccc; padding: 0.5rem; }
    .meta { margin-bottom: 1.5rem; color: #666; font-size: 0.9rem; }
    .download-btn { margin-top: 1rem; padding: 0.4rem 0.8rem; }
  </style>
</head>
<body>
  <h1 id="pdfTitle">è·ä½ç•«åƒ PDF é è¦½</h1>
  <div class="meta" id="timestamp"></div>

  <div id="pdfContent"></div>

  <button class="download-btn" onclick="window.print()">ğŸ“„ ä¸‹è¼‰ PDF</button>

<script>
function renderPDFPage() {
  const params = new URLSearchParams(window.location.search);
  const index = parseInt(params.get("index"), 10);
  const raw = localStorage.getItem("roles");
  const roles = raw ? JSON.parse(raw) : [];

  if (isNaN(index) || !roles[index]) {
    document.getElementById("pdfContent").innerHTML = "<p>æŸ¥ç„¡è·ä½è³‡æ–™ã€‚</p>";
    return;
  }

  const role = roles[index];
  document.getElementById("pdfTitle").innerText = "è·ä½ç•«åƒï½œ" + role.role;
  document.getElementById("timestamp").innerText = "åŒ¯å‡ºæ—¥æœŸï¼š" + new Date().toLocaleString("zh-TW");

  let html = `
    <div class="section-block">
      <h3>ğŸ“Œ è·ä½åç¨±ï¼š${role.role}</h3>
      <p><strong>å·¥ä½œèªªæ˜ï¼š</strong>${role.description}</p>
    </div>
    ${generateTable("ğŸ“ å­¸æ­·", role.hard.edu)}
    ${generateTable("ğŸ“‚ ç¶“æ­·", role.hard.exp)}
    ${generateTable("ğŸ› ï¸ å°ˆæ¥­æŠ€èƒ½", role.hard.skill)}
  `;

  role.soft.forEach(s => {
    html += generateTable(`ğŸŒŸ è»Ÿå¯¦åŠ›ï½œ${s.title}`, s);
  });
  role.trait.forEach(s => {
    html += generateTable(`ğŸ’¡ äººæ ¼ç‰¹è³ªï½œ${s.title}`, s);
  });
  role.avoid.forEach(s => {
    html += generateTable(`âš ï¸ æ‡‰é¿å…ç‰¹è³ªï½œ${s.title}`, s);
  });

  document.getElementById("pdfContent").innerHTML = html;
}

function generateTable(title, item) {
  const rows = item.scores.map(s => `<tr><td colspan="2">${s}</td></tr>`).join('');
  return `
    <div class="section-block">
      <h3>${title}</h3>
      <p><strong>æè¿°ï¼š</strong>${item.desc}</p>
      <table>${rows}</table>
    </div>
  `;
}

window.onload = renderPDFPage;
</script>
</body>
</html>
